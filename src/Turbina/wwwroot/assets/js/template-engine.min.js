class TemplateEngine{constructor(n){this._session=n;this._nodeTemplates=new Map;this._pinTemplates=new Map}getTemplate(n){return new Promise(t=>{let i=this._pinTemplates.get(n);i?t(i):this._loadPinTemplate(n).then(r=>{i=document.createElement("template"),i.innerHTML=r.html,i={html:i,js:r.js},this._pinTemplates.set(n,i),t(i)})})}_loadPinTemplate(n){return fetch("/api/templates/"+n).then(n=>n.json())}}